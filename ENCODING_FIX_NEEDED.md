# UTF-8 编码修复说明

## 问题描述
项目中多个 Go 文件存在 UTF-8 编码错误，主要表现为中文注释中的字符被损坏（显示为 �?）。

## 已修复的文件
- ✅ internal/handler/agent.go (部分)
- ✅ internal/handler/user_group.go
- ✅ internal/middleware/middleware.go
- ✅ internal/handler/handler.go
- ✅ internal/handler/server.go

## 仍需修复的文件
以下文件包含大量编码错误，需要批量修复：

### 高优先级
1. **internal/handler/agent.go** - 还有多处编码错误
2. **internal/service/telegram.go** - 大量中文消息文本损坏
3. **pkg/utils/crypto.go** - 注释中的编码错误
4. **internal/handler/user_group.go** - 部分注释损坏

### 修复方法

#### 方法 1：使用文本编辑器批量替换
在支持正则表达式的编辑器中：
1. 搜索：`�`
2. 手动检查每个匹配项并修复为正确的中文字符

#### 方法 2：重新输入中文注释
对于损坏严重的文件，建议重新输入中文注释。

#### 方法 3：使用 iconv 转换
```bash
# 检查文件编码
file -i filename.go

# 如果需要转换
iconv -f ISO-8859-1 -t UTF-8 filename.go > filename_fixed.go
```

## 常见损坏字符对照表
- `�?` → `和`
- `�?` → `或`
- `�?` → `从`
- `�?` → `件`
- `�?` → `态`
- `�?` → `息`
- `�?` → `机`
- `�?` → `量`
- `�?` → `计`
- `�?` → `组`
- `�?` → `细`
- `�?` → `本`
- `�?` → `端`
- `�?` → `务`
- `�?` → `钥`
- `�?` → `为`
- `�?` → `回`
- `�?` → `口`
- `�?` → `符`
- `�?` → `户`
- `�?` → `餐`
- `�?` → `版`
- `�?` → `令`
- `�?` → `输`
- `�?` → `看`
- `�?` → `找`
- `�?` → `他`
- `�?` → `定`
- `�?` → `败`
- `�?` → `功`
- `�?` → `先`
- `�?` → `绑`
- `�?` → `未`
- `�?` → `请`
- `�?` → `确`
- `�?` → `取`
- `�?` → `解`
- `�?` → `吗`
- `�?` → `正`
- `�?` → `无`
- `�?` → `已`
- `�?` → `总`
- `�?` → `元`

## 建议
1. 在提交代码前，使用 `go build` 检查是否有编码错误
2. 配置编辑器使用 UTF-8 编码保存文件
3. 避免在 Windows 记事本中编辑 Go 文件
4. 使用 VS Code、GoLand 等现代编辑器，它们默认使用 UTF-8

## 验证方法
```bash
# 检查所有 Go 文件的编码
find . -name "*.go" -exec file -i {} \; | grep -v "utf-8"

# 编译检查
go build ./...
```
